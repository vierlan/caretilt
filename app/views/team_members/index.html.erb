<turbo-frame id="main-content">
  <h2>Add team member</h2>

  <div id="new_member">
    <%= turbo_frame_tag "new_member" do %>
      <%= render "form", user: User.new %>
    <% end %>
  </div>

  <!-- Table -->
  <div class="mt-8 flow-root">
    <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
      <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
        <table class="min-w-full">
          <thead class="bg-white">
            <tr>
              <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-base font-semibold text-gray-900 sm:pl-3">Name</th>
              <th scope="col" class="px-3 py-3.5 text-left text-base font-semibold text-gray-900">Title</th>
              <th scope="col" class="px-3 py-3.5 text-left text-base font-semibold text-gray-900">Email</th>
              <th scope="col" class="px-3 py-3.5 text-left text-base font-semibold text-gray-900">Role</th>
              <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-3">
                <span class="sr-only">Edit</span>
              </th>
            </tr>
          </thead>
          <tbody class="bg-white">
            <tr class="border-t border-gray-200">
              <th colspan="5" class="bg-gray-100 py-2 pl-4 pr-3 text-left text-base font-bold text-black sm:pl-3">Invitation Sent - Awaiting Verification</th>
            </tr>

            <tbody id="member-list">
              <!-- This is where new members will be dynamically injected -->
              <%= @unverified_users.each do |user| %>
                <%= render partial: "member", locals: { user: user } %>
              <% end %>
            </tbody>

            <tr class="border-t border-gray-200">
              <th colspan="5" class="bg-gray-100 py-2 pl-4 pr-3 text-left text-base font-bold text-black sm:pl-3"><%= @company.name %></th>
            </tr>

            <!-- Existing members -->
            <% @unassigned_users.each do |user| %>
              <%= render partial: "member", locals: { user: user } %>
            <% end %>

            <% @care_homes.each do |care_home| %>
              <tr class="border-t border-gray-200">
                <th colspan="5" class="bg-gray-100 py-2 pl-4 pr-3 text-left text-base font-bold text-black sm:pl-3"><%= care_home.name %></th>
              </tr>
              <% care_home.users.each do |user| %>
                <%= render partial: "member", locals: { user: user } %>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</turbo-frame>
